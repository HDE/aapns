user  nginx;
worker_processes  1;

error_log  - info;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
}


http {
 http2_max_concurrent_streams 1234567890;
 http2_max_requests 1234567890;
 http2_body_preread_size 65535;
 http2_idle_timeout 1s;

 upstream slow_responder {
  server slow_responder:8080;
  keepalive 1024;
 }

 server { 
  listen 2015 http2;
  listen 2197 ssl http2;
  ssl_certificate     cert.pem;
  ssl_certificate_key key.pem;
  ssl_verify_client optional;
  ssl_client_certificate client-ca.pem;

  error_page 500 /500.html;
  location /500.html{ return 500 '{"error": "nginx:500"}'; }
  error_page 502 /502.html;
  location /502.html{ return 502 '{"error": "nginx:502"}'; }
  error_page 503 /503.html;
  location /503.html{ return 503 '{"error": "nginx:503"}'; }

  location / {
   proxy_pass http://slow_responder;
  }
 }
}
